
<!DOCTYPE html>
<html lang="zh-CN">
<head>
 <meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<meta HTTP-EQUIV="pragma" CONTENT="no-cache">
<meta HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<meta HTTP-EQUIV="expires" CONTENT="0">
<meta name="author" content="bwrong, wang11535041@qq.com"/>
<meta name="keywords" content="【前端工程化】篇二 白璧微瑕-包管理器 | BWrong的小站,前端,krpano,js,vue"/>
<meta name="description" content="天青色等烟雨，而我在等你"/>
<!-- <title>【前端工程化】篇二 白璧微瑕-包管理器 | BWrong的小站</title> -->
<title>网站搭建测试</title>
<link href="https://www.bwrong.cn/media/css/fz.css" rel="stylesheet">
<link rel="stylesheet" href="https://www.bwrong.cn/styles/main.css">
<script type="text/javascript">
function getCSS()
{
        datetoday = new Date();
        timenow=datetoday.getTime();
        datetoday.setTime(timenow);
        thehour = datetoday.getHours();

        if (thehour<5)

            display = "https://www.bwrong.cn/media/css/night.css";

       else if (thehour>20)

            display = "https://www.bwrong.cn/media/css/night.css";

        else if (thehour>5)
     
            display = "https://www.bwrong.cn/media/css/day.css";

        else if (thehour<20)

            display = "https://www.bwrong.cn/media/css/day.css";


var css = '<';
        css+='link rel="stylesheet" href='+display+' \/';
        css+='>';
        document.write(css);
}
</script>
<link href="https://at.alicdn.com/t/font_1306644_ko4c4at97is.css" rel="stylesheet" />
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://www.bwrong.cn/media/css/katex.min.css">
<script type='text/javascript' src='https://www.bwrong.cn/media/scripts/script.js'></script>
<link href="https://cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet" />
  <script src="https://cdn.bootcss.com/wow/1.1.2/wow.min.js"></script>
  <script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script>wow=new WOW({boxClass:'wow',animateClass:'animated',offset:0,mobile:true,live:true});wow.init();</script>

<script type="text/javascript">
window.onload=getCSS();
</script>
<!-- 百度统计 -->
<script>
var _hmt = _hmt || [];
(function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?2c0e9e3f54ae20480b34c178578c4df8";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="post-template-default single single-post postid-70 single-format-standard">
    <div id="wrapper">

	
<header id="header" class="site-header"
		
		style="background-image: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),url(https://www.bwrong.cn/post-images/dev-tools02.jpg)"
		
		>
			<div class="site-branding">
									<h1 class="site-title"><a href="https://www.bwrong.cn" rel="home">BWrong的小站</a></h1>

					<h2 class="site-description">天青色等烟雨，而我在等你</h2>

							</div>
			<nav id="nav-wrapper">
				<div class="container">
					<div class="nav-toggle">
						<div class="bars">
							<div class="bar"></div>
							<div class="bar"></div>
							<div class="bar"></div>
						</div>
					</div>
					<div class="clear"></div>
					<ul id="" class="dove">
		 

<li>

	
		<a href="/">
		  首页
		</a>
	  

    

<li>

	
		<a href="/archives/index.html">
		  归档
		</a>
	  

    

<li>

	
		<a href="/post/about/">
		  关于
		</a>
	  

    

</ul>
</li>

</ul>				</div>
			</nav>
						<div class="jingge">


    

    

<a  href="https://github.com/BWrong" target="_blank" ><i class="iconfont icon-github"></i></a>
 
    

    

    

    

<a  href="https://juejin.cn/user/3421335914820280" target="_blank" ><i class="iconfont icon-telegram"></i></a>
 
    

    

    

    

    

    
        </header>


		<div id="content" class="container">
			<div class="row">
	<div class="col-md-8 site-main">

<article id="post-70" class="post-70 post type-post status-publish format-standard hentry category-5 tag-10 tag-9 tag-11">



		<div class="entry-content">
			<h1 data-wow-delay="0.4s"  class="wow fadeInUp entry-title">【前端工程化】篇二 白璧微瑕-包管理器</h1>
<div class="entry-meta">
<div class="wow fadeInUp"  data-wow-delay="0.6s">
	<i class="iconfont icon-rili"> <time class="lately-a" datetime="2020-10-13 13:09:40" itemprop="datePublished" pubdate="">2020-10-13</time></i>
	          </div>

</span>

		</div>

			<div class="wow fadeInUp entry-summary song"  data-wow-delay="0.1s">
				<p>字数：4533， 阅读时间：12分钟，点击<a href="https://www.bwrong.cn/post/dev-tools02/">阅读原文</a></p>
<figure data-type="image" tabindex="1"><img src="https://gitee.com/letwrong/Picture/raw/master/20201010113133.jpg" alt="" loading="lazy"></figure>
<blockquote>
<p>一个没有长夜痛哭过的人，不配讲悲伤。一个每遇挫折都要痛哭的人，还是不必三十而立了。 ——三毛</p>
</blockquote>
<p>【前端工程化】系列文章链接：</p>
<ul>
<li><a href="https://www.bwrong.cn/post/dev-tools01/">01 扬帆起航-开发环境</a></li>
</ul>
<h2 id="缘起">缘起</h2>
<p>在很久很久以前，前端叫做“切图仔”，那时前端的工作非常简单，只需将设计图还原成代码，最多再加上一些交互和特效，前端的工作非常简单，甚至很多公司没有专门的前端工程师，而这部分工作由后端老哥们兼职。而且那时缺少代码共享平台，项目中造的很多轮子无法分享或者较难分享，代码的复用也只能CV，大家都是单打独斗、各自为战。即使用到了第三方的一些插件，也只能下载后手动进行管理，维护极为不方便。</p>
<p>后来，NodeJS出现了，作为一门服务端语言，它的复杂程度远比当时前端项目要高得多，如果还是手动来管理依赖那将是件很痛苦的事情，所以NPM应运而生，从此它担任了前端项目依赖管理的角色，开启了JavaScript生态的一片繁华。</p>
<p>在开始介绍前，先简单介绍几个概念：</p>
<ul>
<li>包：包即是一段能复用的代码，它可以存在开发者本地和云端，每个包可能依赖也可能不会依赖其他包。</li>
<li>包管理器：对包进行管理的工具，可以追溯包的版本、依赖、作者等相关信息，还可以将云端的包下载到本地，在项目中使用。</li>
</ul>
<h2 id="npm">NPM</h2>
<p>npm即<code>Node Package Manager</code>，开发者可在上面分享自己的代码包，现在平台上已有上百万个包，而使用它可以轻松管理包的依赖及其版本。</p>
<p>npm主要有三个部分组成：</p>
<ul>
<li><a href="https://www.npmjs.com/">网站</a>：开发者查找包（package）的主要途径，可以通过不同的条件进行检索，还可以对自己或者自己组织账户进行管理。</li>
<li>注册表：相当于一个庞大的数据库，保存了每个包（package）的相关信息。</li>
<li>命令行工具：用以支持通过终端执行命令的方式来运行。</li>
</ul>
<p>NPM是NodeJS官方的包管理器，所以默认会在安装NodeJS的时候一起安装，具体的安装及配置请见上一篇《开发环境搭建》。</p>
<p>NPM我相信大家都是比较熟悉了，所以下面仅仅介绍一下常用的用法。</p>
<h3 id="常用命令">常用命令</h3>
<h4 id="生成配置文件packagejson">生成配置文件<code>package.json</code></h4>
<pre><code class="language-shell">npm init [配置]
</code></pre>
<p>配置：</p>
<ul>
<li>-y（--yes） ：略过问答配置模式，所有配置项将全部使用默认值。</li>
</ul>
<h4 id="搜索包">搜索包</h4>
<pre><code class="language-shell">npm search &lt;包名&gt;
</code></pre>
<p><strong>注意：</strong> <strong>如果更改了npm的镜像源，搜索包时需要切换到npm官方源。</strong></p>
<p>npm包的开发门槛很低，数量众多，重复的轮子也多得出奇，每次选择一个包对选择强迫症患者来说，并不是一件容易的事情，一般我们可以考虑以下几点因素：</p>
<ul>
<li>下载量，和买东西看销量一个道理，相信大多数人的选择总是没错的。</li>
<li>维护的活跃程度，包括最后更新时间、更新频率，是否可以给作者提交issues及其修复情况，总之就是看作者有没有用心在维护，有的项目是为了应付公司KPI，可能过段时间就凉凉了。</li>
<li>文档是否完善，没文档就是在看天书，不会想让我去啃源码吧，我头发可不多了😭  😭。</li>
</ul>
<h4 id="安装包">安装包</h4>
<pre><code class="language-shell">npm install &lt;包名&gt; [配置] # install 可以简写为i
</code></pre>
<p>配置：</p>
<ul>
<li>-g (--global)：将包作为全局依赖安装，一般一些在终端使用的命令工具之类会选择此方式。</li>
<li>-S (--save)：将包作为生产依赖安装，一般在生产（线上）环境使用的依赖都采用此方式，不指定默认也是此方式。</li>
<li>-D (--save-dev)：将包作为开发依赖安装，一般开发环境使用的一些辅助工具都采用此方式安装，如eslint、babel。</li>
</ul>
<p>可以在包名后面加上版本号以安装特定版本号，如<code>npm install vue@2.16.1</code>。</p>
<h4 id="卸载包">卸载包</h4>
<pre><code class="language-shell">npm uninstall &lt;包名&gt; [配置]
</code></pre>
<p>配置和安装包配置一样，不同配置表示卸载不同地方的包。</p>
<h4 id="更新包">更新包</h4>
<pre><code class="language-shell">npm update &lt;包名&gt; [配置]
</code></pre>
<p>配置和安装包配置一样，不同配置表示更新不同地方的包。</p>
<h4 id="发布包">发布包</h4>
<pre><code class="language-shell">npm publish [配置]
</code></pre>
<p>配置：</p>
<ul>
<li>--tag beta: 指定标签，默认为版本号，如<code>npm publish --tag beta</code>。</li>
</ul>
<h4 id="安全性检测">安全性检测</h4>
<pre><code class="language-shell">npm audit # 对包及其依赖进行安全检测，并生成报告
npm audit fix # 自动为易受攻击的依赖项安装兼容的更新
npm set audit false # 关闭检测机制
</code></pre>
<p>由于npm包的数量众多，而且很多包早已没有维护了，难免会出现一些安全隐患，所以安全性检测可以帮助我们做一些排查，增强安全性。前面就出现了一些包会泄露用户数据的问题，所以安全性检测是很有必要的。</p>
<p>注意：<strong>安全性检测需要切换到npm官方镜像源。</strong></p>
<h4 id="清除缓存">清除缓存</h4>
<pre><code class="language-shell">npm cache clean --force #强制清除npm缓存
</code></pre>
<p>为了加快安装包的速度，NPM会在安装包的时候把他们缓存到本地，再次安装这些包的时候，直接从缓存拷贝，使用该命令可以清除缓存。</p>
<h2 id="npx">NPX</h2>
<p>npm在5.2版本内置了npx工具，也可以使用<code>npm install -g npx</code>手动安装，主要用来在终端调用项目本地安装的模块，从而可以避免一些全局包的安装。</p>
<ul>
<li>调用项目中安装的包</li>
</ul>
<p>如果我们在项目中安装了gulp，要执行gulp相关的命令，如果在项目目录下直接执行的话，它会去全局的包查找，如果要避免这种情况，就只能将命令定义在<code>package.json</code>的scripts中，然后通过<code>npm run</code>的方式来执行。如果使用npx，就会避免这种情况，因为它会优先去项目本地中寻找。</p>
<pre><code class="language-shell">npx gulp --version
</code></pre>
<ul>
<li>避免全局安装模块</li>
</ul>
<p>一般在使用一些脚手架的时候，我们需要在全局安装后才可使用，如果使用npx就不需要。</p>
<pre><code class="language-shell">npx create-react-app my-react-app
</code></pre>
<p>npx 将<code>create-react-app</code>下载到一个临时目录，使用以后再删除，避免了安装全局模块。</p>
<ul>
<li>执行远程代码</li>
</ul>
<pre><code class="language-shell"># 执行 Gist 代码
$ npx https://gist.github.com/zkat/4bc19503fe9e9309e2bfaa2c58074d32

# 执行仓库代码
$ npx github:piuccio/cowsay hello
</code></pre>
<p>参考资料：<a href="http://www.ruanyifeng.com/blog/2019/02/npx.html">npx 使用教程</a></p>
<h2 id="packagejson">package.json</h2>
<p><code>package.json</code>是npm的配置文件，一般存在于项目的根目录中，记录了当前项目信息及其依赖包信息。</p>
<p>配置格式为JSON，常用配置项如下：</p>
<h5 id="必填字段">必填字段</h5>
<ul>
<li>name：包或项目的名字，不能以点（<code>.</code>）或下划线（<code>_</code>）开头，不能包含中文、大写字母及非URL安全字符，长度必须小于或等于214个字符，@开头的包标识它是Scoped包。</li>
<li>version：包当前的版本号，遵循 <a href="http://semver.org/lang/zh-CN/">Semantic Versioning 2.0.0</a> 语义化版本规范。</li>
</ul>
<h5 id="信息类字段">信息类字段</h5>
<ul>
<li>
<p><code>description</code>：包的描述信息。</p>
</li>
<li>
<p><code>keywords</code>：关键字，值为一个字符串数组，在检索包时很有用。</p>
</li>
<li>
<p><code>license</code>：许可证，以便让用户了解他们是在什么授权下使用此包，以及此包还有哪些附加限制。</p>
</li>
</ul>
<pre><code class="language-json">{
  &quot;license&quot;: &quot;MIT&quot;,
  &quot;license&quot;: &quot;(MIT or GPL-3.0)&quot;,
  &quot;license&quot;: &quot;SEE LICENSE IN LICENSE_FILENAME.txt&quot;,
  &quot;license&quot;: &quot;UNLICENSED&quot;
}
</code></pre>
<h5 id="链接类字段">链接类字段</h5>
<p>各种指向项目文档、issues 上报，以及代码托管网站的链接字段。</p>
<ul>
<li>
<p><code>homepage</code>：是包的项目主页或者文档首页。</p>
</li>
<li>
<p><code>bugs</code>：问题反馈系统的 URL，或者是 email 地址之类的链接。方便用户通过该途径向包作者反馈问题。</p>
</li>
<li>
<p><code>repository</code>：是包代码托管的位置。</p>
</li>
</ul>
<pre><code class="language-json">{
  &quot;repository&quot;: { &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;https://github.com/user/repo.git&quot; },
  &quot;repository&quot;: &quot;github:user/repo&quot;,
  &quot;repository&quot;: &quot;gitlab:user/repo&quot;,
  &quot;repository&quot;: &quot;bitbucket:user/repo&quot;,
  &quot;repository&quot;: &quot;gist:a1b2c3d4e5f&quot;
}
</code></pre>
<h5 id="项目维护类字段">项目维护类字段</h5>
<p>项目维护者的相关信息。</p>
<ul>
<li><code>author</code>：作者信息，一个人。</li>
</ul>
<pre><code class="language-json">{
  &quot;author&quot;: { &quot;name&quot;: &quot;Your Name&quot;, &quot;email&quot;: &quot;you@example.com&quot;, &quot;url&quot;: &quot;http://your-website.com&quot; },
  &quot;author&quot;: &quot;Your Name &lt;you@example.com&gt; (http://your-website.com)&quot;
}
</code></pre>
<ul>
<li><code>contributors</code>：贡献者信息，可以是多个人。</li>
</ul>
<pre><code class="language-json">{
  &quot;contributors&quot;: [
    { &quot;name&quot;: &quot;Your Friend&quot;, &quot;email&quot;: &quot;friend@example.com&quot;, &quot;url&quot;: &quot;http://friends-website.com&quot; }
    { &quot;name&quot;: &quot;Other Friend&quot;, &quot;email&quot;: &quot;other@example.com&quot;, &quot;url&quot;: &quot;http://other-website.com&quot; }
  ],
  &quot;contributors&quot;: [
    &quot;Your Friend &lt;friend@example.com&gt; (http://friends-website.com)&quot;,
    &quot;Other Friend &lt;other@example.com&gt; (http://other-website.com)&quot;
  ]
}
</code></pre>
<h5 id="文件类信息">文件类信息</h5>
<p>指定包含在项目中的文件，以及项目的入口文件。</p>
<ul>
<li><code>files</code>：项目包含的文件，可以是单独的文件、整个文件夹，或者通配符匹配到的文件。</li>
</ul>
<pre><code class="language-json">{
  &quot;files&quot;: [
    &quot;filename.js&quot;,
    &quot;directory/&quot;,
    &quot;glob/*.{js,json}&quot;
  ]
}
</code></pre>
<ul>
<li><code>main</code>：项目的入口文件。</li>
</ul>
<pre><code class="language-json">{
  &quot;main&quot;: &quot;filename.js&quot;
}
</code></pre>
<ul>
<li><code>bin</code>：随着项目一起被安装的可执行文件，开发命令行工具、脚手架会用到此项。</li>
</ul>
<pre><code class="language-json">{
  &quot;bin&quot;: &quot;bin.js&quot;,
  &quot;bin&quot;: {
    &quot;other-command&quot;: &quot;bin/other-command&quot;
  }
}
</code></pre>
<ul>
<li><code>directories</code>：当你的包安装时，你可以指定确切的位置来放二进制文件、man pages、文档、例子等。</li>
</ul>
<pre><code class="language-json">{
  &quot;directories&quot;: {
    &quot;lib&quot;: &quot;path/to/lib/&quot;,
    &quot;bin&quot;: &quot;path/to/bin/&quot;,
    &quot;man&quot;: &quot;path/to/man/&quot;,
    &quot;doc&quot;: &quot;path/to/doc/&quot;,
    &quot;example&quot;: &quot;path/to/example/&quot;
  }
}
</code></pre>
<ul>
<li><code>types</code>：指定 <a href="https://www.typescriptlang.org/docs/handbook/declaration-files/publishing.html">TypeScript</a> 中的类型声明文件</li>
</ul>
<pre><code class="language-json">{
  &quot;types&quot;: &quot;./lib/main.d.ts&quot;,
}
</code></pre>
<h5 id="任务类字段">任务类字段</h5>
<p>脚本是定义自动化开发相关任务的好方法，比如使用一些简单的构建过程或开发工具。 在 <code>scripts</code> 字段里定义的脚本，可以通过<code>npm run xxx</code> 命令来执行。 例如， <code>build-project</code> 脚本可以通过 <code>npm run build-project</code> 调用，并执行 <code>node build-project.js</code>。</p>
<pre><code class="language-json">{
  &quot;scripts&quot;: {
    &quot;build-project&quot;: &quot;node build-project.js&quot;
  }
}
</code></pre>
<p>有一些特殊的脚本名称（可以理解为生命钩子）。 如果定义了 <code>preinstall</code> 脚本，它会在包安装前被调用。 出于兼容性考虑，<code>install</code>、<code>postinstall</code> 和 <code>prepublish</code> 脚本会在包完成安装后被调用。</p>
<h6 id="特定的-scripts">特定的 <code>scripts</code></h6>
<ul>
<li><code>prepublish</code>: 在打包并发布包之前运行，以及在没有任何参数的本地 <code>npm</code> 安装之前运行。</li>
<li><code>prepare</code>: 在打包和发布包之前运行，在没有任何参数的本地 <code>npm install</code> 上运行，以及安装 git 依赖项时。 这是在 <code>preublish</code> 之后运行，但是在 <code>preublishOnly</code> 之前运行。</li>
<li><code>prepublishOnly</code>: 在包准备和打包之前运行，仅限于npm发布。</li>
<li><code>prepack</code>: 在打包 <code>tarball</code> 之前运行（在 <code>npm pack</code>，<code>npm publish</code>，以及安装 git 依赖项时）</li>
<li><code>postpack</code>: 在生成 <code>tarball</code> 之后运行并移动到其最终目标。</li>
<li><code>publish</code>, <code>postpublish</code>: 在包发布后运行。</li>
<li><code>preinstall</code>: 在安装软件包之前运行。</li>
<li><code>install</code>, <code>postinstall</code>: 安装包后运行。</li>
<li><code>preuninstall</code>, <code>uninstall</code>: 在卸载软件包之前运行。</li>
<li><code>postuninstall</code>: 在卸载软件包之后运行。</li>
<li><code>preversion</code>: 在改变包版本之前运行。</li>
<li><code>version</code>: 改变包版本后运行，但提交之前。</li>
<li><code>postversion</code>: 改变包版本后运行，然后提交。</li>
<li><code>pretest</code>, <code>test</code>, <code>posttest</code>: 由 <code>npm test</code> 命令运行。</li>
<li><code>prestop</code>, <code>stop</code>, <code>poststop</code>: 由 <code>npm stop</code> 命令运行。</li>
<li><code>prestart</code>, <code>start</code>, <code>poststart</code>: 由 <code>npm start</code> 命令运行。</li>
<li><code>prerestart</code>, <code>restart</code>, <code>postrestart</code>: 由 <code>npm restart</code> 命令运行。 注意：如果没有提供重启脚本，<code>npm restart</code> 将运行 <code>stop</code> 和<code>start</code> 脚本。</li>
<li><code>preshrinkwrap</code>, <code>shrinkwrap</code>, <code>postshrinkwrap</code>: 由 <code>npm shrinkwrap</code> 命令运行。</li>
</ul>
<h5 id="依赖描述类字段">依赖描述类字段</h5>
<p>记录了当前项目或者包的其他依赖。</p>
<ul>
<li><code>dependencies</code>：这些是开发环境和生产环境都需要的依赖包，使用<code>npm i -S</code>xxx 安装。</li>
</ul>
<pre><code class="language-json">{
  &quot;dependencies&quot;: {
    &quot;package-1&quot;: &quot;^3.1.4&quot;,
    &quot;package-2&quot;: &quot;file:./path/to/dir&quot;
  }
}
</code></pre>
<blockquote>
<p>包的版本遵循如下规则：</p>
<ul>
<li>
<p>补丁发布：<code>1.0</code>或<code>1.0.x</code>或<code>~1.0.4</code></p>
</li>
<li>
<p>次要版本：<code>1</code>或<code>1.x</code>或<code>^1.0.4</code></p>
</li>
<li>
<p>主要版本：<code>*</code>或<code>x</code></p>
</li>
</ul>
<p>你可以指定一个确切的版本、一个最小的版本 (比如 <code>&gt;=</code>) 或者一个版本范围 (比如 <code>&gt;= ... &lt;</code>)。<br>
包也可以指向本地的一个目录文件夹。</p>
</blockquote>
<ul>
<li><code>devDependencies</code>：这些是仅开发环境需要的依赖包，一般是一些构建辅助工具之类的，使用<code>npm i -D xxx</code>安装。</li>
</ul>
<pre><code class="language-json">{
  &quot;devDependencies&quot;: {
    &quot;package-2&quot;: &quot;^0.4.2&quot;
  }
}
</code></pre>
<p>我们在安装包时，最好根据使用环境来放到对应位置，不要不分环境随处安装，养成良好的习惯，因为一些部署工具可能会对此有要求。</p>
<blockquote>
<p>我们安装的包前面一半都会带上<code>^</code>或者<code>~</code>的符号，有什么作用呢？</p>
<ul>
<li><code>~</code>会匹配最近的小版本依赖包，如<code>~1.2.3</code>会匹配所有<code>1.2.x</code>版本，但是不包括<code>1.3.0</code>。</li>
<li><code>^</code>会匹配最新的大版本依赖包，如<code>^1.2.3</code>会匹配所有<code>1.x.x</code>的包，包括<code>1.3.0</code>，但是不包括<code>2.0.0</code>。</li>
<li>不带上面两种符号的，即固定版本号，如<code>1.2.3</code>仅匹配<code>1.2.3</code>版本。</li>
</ul>
</blockquote>
<p>参考资料：<a href="https://github.com/jaywcjlove/package.json"> package.json 说明文档</a></p>
<h2 id="package-lockjson">package-lock.json</h2>
<p>原则上，包的发布需要严格遵循 <a href="http://semver.org/">语义版本控制</a> 规则，但是这并不是一个强制的规则，难免版本更新会带来一些不兼容的特性。如果不锁定版本，有可能会出现根据同一份 <code>package.json</code> 文件，但安装了不同版本的包，导致出现一些兼容性错误，所以npm在安装时就会生成该文件来锁定版本，保证安装软件版本的一致性。</p>
<h2 id="查找规则">查找规则</h2>
<p>npm包在使用时遵循如下查找规则：</p>
<ol>
<li>在当前目录下查找node_modules目录；如果没有则向上一层目录查找，如果也没有则继续向上层目录查找直到根目录； 如果都没有则报错。</li>
<li>进入node_modules中查找对应包名字的目录；如果没有则报错。</li>
<li>进入包名目录查找 package.json 文件中的 main 配置项，导入该配置项指定的文件。</li>
<li>如果模块名目录中没有 package.json文件，或package.json文件中没有 main 配置项，则加载 index.js 文件；如果<code>index.js</code>也没有则报错。</li>
</ol>
<h2 id="yarn">Yarn</h2>
<p><a href="https://yarnpkg.com/">Yarn</a> 是一个由 Facebook，Google，Exponent 和 Tilde 构建的新的 JavaScript 包管理器。正如<a href="https://code.facebook.com/posts/1840075619545360">官方公告</a>所写，它的目标就是解决这些团队使用 npm 的时候所遇到的几个问题，即：</p>
<ul>
<li>安装包不够快速和稳定。</li>
<li>存在安全隐患，因为 npm 允许包在安装的时候运行代码。</li>
</ul>
<p>它并不是想要完全替代 npm。Yarn 仅仅是一个能够从 npm 仓库获取到包的新的 CLI 客户端，它和NPM相比，有如下优势：</p>
<h4 id="更清晰的输出">更清晰的输出</h4>
<p>yarn的输出很清晰，使用了emoji，看起来也更加漂亮，颜值党必备。</p>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/letwrong/Picture/raw/master/20200603214049.jpg" alt="“yarn install” 命令的输出" loading="lazy"></figure>
<h4 id="并行安装">并行安装</h4>
<p>在安装多个包时，npm会按包顺序串行执行，也就是只有当一个包全部安装完成后，才会安装下一个。Yarn 则是并行执行，更加高效。</p>
<h3 id="yarn和npm的命令对比">yarn和npm的命令对比</h3>
<ul>
<li>有区别的命令</li>
</ul>
<table>
<thead>
<tr>
<th>Npm</th>
<th>Yarn</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>npm install(npm i)</code></td>
<td><code>yarn install(yarn)</code></td>
<td>根据 <code>package.json</code> 安装所有依赖</td>
</tr>
<tr>
<td><code>npm i –save [package]</code></td>
<td><code>yarn add [package]</code></td>
<td>添加依赖包至 dependencies</td>
</tr>
<tr>
<td><code>npm i –save-dev [package]</code></td>
<td><code>yarn add [package] –dev</code></td>
<td>添加依赖包至 devDependencies</td>
</tr>
<tr>
<td><code>npm i -g [package]</code></td>
<td><code>yarn global add [package]</code></td>
<td>安装全局依赖包</td>
</tr>
<tr>
<td><code>npm update –save</code></td>
<td><code>yarn upgrade [package]</code></td>
<td>升级依赖包</td>
</tr>
<tr>
<td><code>npm uninstall [package]</code></td>
<td><code>yarn remove [package]</code></td>
<td>移除依赖包</td>
</tr>
</tbody>
</table>
<ul>
<li>相同操作的命令</li>
</ul>
<table>
<thead>
<tr>
<th>Npm</th>
<th>Yarn</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>npm run</code></td>
<td><code>yarn run</code></td>
<td>运行 <code>package.json</code> 中预定义的脚本</td>
</tr>
<tr>
<td><code>npm config list</code></td>
<td><code>yarn config list</code></td>
<td>查看配置信息</td>
</tr>
<tr>
<td><code>npm config set registry 仓库地址</code></td>
<td><code>yarn config set registry 仓库地址</code></td>
<td>更换仓库地址</td>
</tr>
<tr>
<td><code>npm init</code></td>
<td><code>yarn init</code></td>
<td>互动式创建/更新 <code>package.json</code> 文件</td>
</tr>
<tr>
<td><code>npm list</code></td>
<td><code>yarn list</code></td>
<td>查看当前目录下已安装的node包</td>
</tr>
<tr>
<td><code>npm login</code></td>
<td><code>yarn login</code></td>
<td>保存你的用户名、邮箱</td>
</tr>
<tr>
<td><code>npm logout</code></td>
<td><code>yarn logout</code></td>
<td>删除你的用户名、邮箱</td>
</tr>
<tr>
<td><code>npm outdated</code></td>
<td><code>yarn outdated</code></td>
<td>检查过时的依赖包</td>
</tr>
<tr>
<td><code>npm link</code></td>
<td><code>yarn link</code></td>
<td>开发时链接依赖包，以便在其他项目中使用</td>
</tr>
<tr>
<td><code>npm unlink</code></td>
<td><code>yarn unlink</code></td>
<td>取消链接依赖包</td>
</tr>
<tr>
<td><code>npm publish</code></td>
<td><code>yarn publish</code></td>
<td>将包发布到 npm</td>
</tr>
<tr>
<td><code>npm test</code></td>
<td><code>yarn test</code></td>
<td>测试 = <code>yarn run test</code></td>
</tr>
<tr>
<td><code>npm bin</code></td>
<td><code>yarn bin</code></td>
<td>显示 bin 文件所在的安装目录</td>
</tr>
<tr>
<td><code>yarn info</code></td>
<td><code>yarn info</code></td>
<td>显示一个包的信息</td>
</tr>
</tbody>
</table>
<p>yarn的命令跟npm的命令差异不大，如果使用过npm，那么过渡到yarn也很简单。npm本身也在不断优化，继续使用也没有关系。</p>
<p>参考资料:<a href="https://www.jeffjade.com/2017/12/30/135-npm-vs-yarn-detial-memo/">Npm vs Yarn 之备忘详单</a></p>
<h2 id="未来">未来</h2>
<p>现在npm还是有很多无法回避的问题，最初<code>node_modules</code>下面每个依赖包的依赖放在自己的目录下面，相同的依赖无法复用，不管是安装还是删除都非常低效，在windows上经常会出现因为超过最大嵌套层级而无法删除的情况，不过好在后来官方调整了架构，改为平铺的结构，解决了这些问题。</p>
<p>不过现阶段npm的包管理还是很混乱，相比其他包管理器，还有很多需要改进的地方。</p>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/letwrong/Picture/raw/master/20200513231518.jpg" alt="" loading="lazy"></figure>
<ul>
<li>存在有很多重复的包，很多不维护的包，这给使用者选择造成了困扰。</li>
<li>依赖过多，比如仅仅开发一个react的demo，结果发现要安装上千个包。</li>
</ul>
<p>npm虽已成为前端依赖管理的标配，但仍有一段路要走，又或者说前端还正在路上。</p>
<p><s>目前npm官方也正在开发下一代包管理工具Tink，相信不久的将来就会和我们见面，是不是很期待呢？</s> 今天去看了下官方仓库，好像没有维护了，估计夭折了 。🤪</p>

							</div>
	<div class="wow fadeInUp vt-post-tags">
 
				<a href="https://www.bwrong.cn/tag/hh5vnFCXD/" rel="tag">yarn</a>
				 
				<a href="https://www.bwrong.cn/tag/OAKcx3nhf/" rel="tag">npm</a>
				 
					</div>
<nav class="navigation3 post-navigation3" role="navigation">

		<div class="nav-links3">
      
		<div class="wow fadeInUp nav-previous3"><a href="https://www.bwrong.cn/post/dev-tools03/" rel="prev"> 【前端工程化】篇三 席卷八荒-Webpack（基础）</a></div>
		 
		 
		<div class="wow fadeInUp nav-next3"><a href="https://www.bwrong.cn/post/dev-tools01/" rel="next"> 【前端工程化】篇一 扬帆起航：开发环境</a></div>
		
		</div>
	</nav>
	<div class="wow fadeInUp author-info">
	<div class="author-avatar pull-left"><img src="https://www.bwrong.cn/images/avatar.png" ></div>
 
	<div class="author-description"><div class="author-title"><div class="author-link" rel="author">BWrong</div></div>


	<p class="author-bio">愿你走出半生，归来仍是少年</p></div></div>
	
		</div>



</article>

<div id="marlin_lite_about_widget-2" class="wow fadeInUp widget marlin_lite_about_widget" data-wow-delay="0.1s">

        
		<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://www.bwrong.cn/media/scripts/Valine.min.js'></script>

<div class="comment"></div>
<script>
        new Valine({
            av: AV,
            el: '.comment',
            lang: 'zh-cn',
            visitor: false, // 阅读量统计
            
            admin_email:'wang11535041@qq.com',
            
            
            emoticon_url: '/media/alu',
             
      emoticon_list: ["吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"],
     
      app_id: 'jaz3TfUjRowK9fOMAPb9yw6i-MdYXbMMI',
      
      
      app_key: 'pbltxx4rElIP1RStL3AwujSp',
         
          
      placeholder: '欢迎你留下足迹'
       
        });
    </script>





		</div>

			</div>
			


<div class="tocc col l3 hide-on-med-and-down">

        <div class="toc-widget">

            <div class="toc-title"></div>

            <div id="toc-content">


			</div>
        </div>
    </div>


<script src="https://www.bwrong.cn/media/scripts/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '.entry-summary',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1,h2' //**
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('.entry-summary').children('h1, h2').each(function () {/**/
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget').parent();
        // let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script>






			</div>
		</div>


		 <footer id="colophon" class="site-footer">

	<div class="container">

		<div class="copyright"> <br>Theme: <a
				href="https://github.com/alterfang/gridea-theme-pan" target="_blank" title="Pan"><span>Pan</span></a>.
			Powered by <a href="https://gridea.dev/" target="_blank" title="Gridea"><span>Gridea</span></a> . 版权所有：<a href="https://beian.miit.gov.cn/" target="_blank"><span>蜀ICP备2023018303号-1</span></a></div>
	</div>

</footer>
		<!-- loding -->
		<div class="loader">
			<div class="loader-content">
				<div class="songjingge">
					<span></span>
					<span></span>
					<span></span>
					<span></span>
					<span></span>
				</div>
			</div>
		</div>
<script id="rendered-js">
	window.onload = function () {
			var loader = document.getElementsByClassName("loader")[0];
			loader.className = "loader fadeout"; //使用渐隐的方法淡出loading page
			setTimeout(function () {
				loader.style.display = "none";
			}, 0);
	};
</script>


</div>

<script src="https://cdn.bootcss.com/fitvids/1.2.0/jquery.fitvids.min.js"></script>
<script type='text/javascript' src='https://www.bwrong.cn/media/scripts/marlin-scripts.js'></script>
<script src="https://www.bwrong.cn/media/scripts/lately.min.js"></script>
<script>jQuery(document).ready(function () { $.lately({ 'target': '.lately-a,.lately-b,.lately-c' }) });</script>
<style type="text/css">
  a.back_to_top {
    text-decoration: none;
    position: fixed;
    bottom: 40px;
    right: 30px;
    background: #f0f0f0;
    height: 40px;
    width: 40px;
    border-radius: 50%;
    line-height: 36px;
    font-size: 18px;
    text-align: center;
    transition-duration: .5s;
    transition-propety: background-color;
    display: none;
  }

  a.back_to_top span {
    color: #888;
  }

  a.back_to_top:hover {
    cursor: pointer;
    background: #dfdfdf;
  }

  a.back_to_top:hover span {
    color: #555;
  }

  @media print,
  screen and (max-width: 580px) {
    .back_to_top {
      display: none !important;
    }
  }
</style><a id="back_to_top" href="#" class="back_to_top"><span><i class="iconfont icon-xiangshang"></i></span>
</a>

<script>
$(document).ready((function (_this) {
    return function () {
      var bt;
      bt = $('#back_to_top');
      if ($(document).width() > 480) {
        $(window).scroll(function () {
          var st;
          st = $(window).scrollTop();
          if (st > 30) {
            return bt.css('display', 'block');
          } else {
            return bt.css('display', 'none');
          }
        });
        return bt.click(function () {
          $('body,html').animate({
            scrollTop: 0
          }, 800);
          return false;
        });
      }
    };
  })(this));
//   $(window).load(function () {
//     //异步延迟加载样式
//     var link = $('<link />');
//     link.attr('href', 'https://fonts.googleapis.com/css?family=Dancing+Script|Noto+Sans+SC:300|Montserrat&display=swap');
//     link.attr('rel', 'stylesheet');
//     link.appendTo($('head'));
// });
</script>

<!-- 宠物 -->
<canvas id="live2dcanvas" width="200" height="400" class="live2d"></canvas>
<style>
  #live2dcanvas {
    position: fixed;
    right: 0px;
    z-index: 999;
    pointer-events: none;
    bottom: -40px;
    width: 200px;
    height: 400px;
  }

  @media (max-width: 768px) {
    #live2dcanvas {
      width: 150px;
      height: 300px;
    }
  }

  @media (max-width: 639px) {
    #live2dcanvas {
      display: none !important;
    }
  }
</style>
<script src="https://www.bwrong.cn/media/scripts/L2Dwidget.min.js"></script>
<script>
  //初始化小人物 需设置属性pluginRootPath: "live2dw/"指明资源跟路径
  L2Dwidget.init({
    pluginRootPath: "media/",//资源root路径
    pluginJsPath: "scripts/",//js相对root的路径
    pluginModelPath: "model/",//模型相对root的路径
    tagMode: !1,
    debug: !1,
    model: {
      scale: 2,
      jsonPath: "/media/model/live2d-widget-model-epsilon/Epsilon2.1.model.json"
    },
    display: {//大小位置什么的自己慢慢调就是了
      position: "right",//定位
      width: 130,//宽度
      height: 210,//高度
      hOffset: -40,//左右
      vOffset: 0//上下
    },
    mobile: {
      show: !1
    },
    log: !1
  });
</script>
<!-- 宠物结束 -->

		<script data-no-instant>
    // (function ($) {
    //     $.extend({
    //         adamsOverload: function () {
    //             $('.navigation:eq(0)').remove();
    //             $("").attr("rel" , "external");
    //             $("a[rel='external'],a[rel='external nofollow']").attr("target","_blank");
    //             $("a.vi").attr("rel" , "");
    //             $.viewImage({
    //                 'target'  : 'img',
    //                 'exclude' : '.vsmile-icons img,.gallery img',
    //                 'delay'   : 300
    //             });
    //             $.lately({
    //                 'target' : '.commentmetadata a,.infos time,.post-list time'
	// 			});
	// 			console.log(prettyPrint)
	// 			if(prettyPrint) prettyPrint();

    //             $('ul.links li a').each(function(){
    //                 if($(this).parent().find('.bg').length==0){
    //                     $(this).parent().append('<!---<div class="bg" style="background-image:url(https://c3.glgoo.top/s2/favicons?domain='+$(this).attr("href")+')"></div>--->')
    //                 }
    //             });
    //         }
    //     });
    // })(jQuery);
	// jQuery.adamsOverload();

    (function ($) {
        $.extend({
            adamsOverload: function () {
                $.viewImage({
                    'target'  : '.song img',
                    'exclude' : '.vsmile-icons img',
                    'delay'   : 300
                });
            }
        });
    })(jQuery);
    jQuery.adamsOverload();
</script>

</body>
</html>
